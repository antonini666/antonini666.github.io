const $ = el => document.querySelector(el),
  $$ = el => document.querySelectorAll(el),
  ls = localStorage;

(function controlColorTheme() {
  if (!ls.getItem("theme")) ls.setItem("theme", 0);

  if (ls.getItem("theme") == 1) {
    $(".color-theme-button").checked = false;
    colorTheme();
  }

  let colorCounter = 0;
  $(".switch-wrapper").onclick = function() {
    colorCounter++;
    if (colorCounter % 2 == 0) {
      ls.getItem("theme") == 0
        ? ls.setItem("theme", 1)
        : ls.setItem("theme", 0);
      colorTheme();
    }
  };

  function colorTheme() {
    $(".first-section a").classList.toggle("github-href-white");
    $$(".slider-b").forEach(it => it.classList.toggle("slider-b-white"));
    $("body").classList.toggle("white-bg");
    $("body").classList.toggle("scroll-white");
    $$(".brk-btn").forEach(it => it.classList.toggle("brk-btn-black"));
    $$(".fa-check").forEach(it => it.classList.toggle("fa-white"));
    $$(".contact").forEach(it => it.classList.toggle("contact-white"));
    $(".fa-phone").classList.toggle("fa-phone-white");
    $(".white-end div").classList.toggle("end-desc-white");
  }
})();

(function controlLanguage() {
  let language = window.navigator
    ? window.navigator.language ||
      window.navigator.systemLanguage ||
      window.navigator.userLanguage
    : "ru";
  language = language.substr(0, 2).toLowerCase();

  if (!ls.getItem("language")) {
    if (language == "ru") {
      $(".language-button").checked = false;
      ruTranslator();
    } else {
      $(".language-button").checked = true;
      language = "en";
    }
  }

  if (ls.getItem("language") == "ru") {
    $(".language-button").checked = false;
    ruTranslator();
  } else {
    $(".language-button").checked = true;
    language = "en";
  }

  let lang = 0;
  $(".switch-language").onclick = () => {
    lang++;
    if (lang % 2 == 0) language == "en" ? ruTranslator() : enTranslator();
  };

  function ruTranslator() {
    $(".color-theme-wrapper > label .switch-desk").classList.add(
      "switch-desk-ru"
    );
    $(".color-theme-wrapper > label .switch-desk").innerText = "Цветная тема";
    $(".switch-desk-lang").innerText = "Russian";
    $(".first-section .h1").classList.add("h1-ru");
    $(".first-section .h3").classList.add("h3-ru");

    $(".first-section .h1").innerText = "Антон Яновский";
    $(".first-section .h3").innerText = "Front-end Developer";

    $(".below-first-screen").innerText = "Ниже представлены мои работы";

    $$(".brk-btn").forEach(it => (it.innerText = "Посетить"));

    $(".portfolio-quiz h2").innerText = "Приложение SongBird на React.js";
    $(".portfolio-quiz h3").innerText =
      "Написал приложение про птичек с использованием React и React Hooks";

    $(".portfolio-library h2").innerText = "Викторина на React.js";
    $(".portfolio-library h3").innerText =
      "Написал викторину на React.js с использованием json-server";

    $(".portfolio-store-react h2").innerText = "Список дела на React.js";
    $(".portfolio-store-react h3").innerText =
      "Написал простой список дел на React.js";

    $(".portfolio-blog-react h2").innerText = "Верстка сайта";
    $(".portfolio-blog-react h3").innerText = "Адаптивный лендинг";

    $(".portfolio-layout h2").innerText = "Верстка сайта";
    $(".portfolio-layout h3").innerText = "Адаптивный лендинг";

    $(".my-skills-title").innerText = "Мои Навыки";
    $(".connect-title").innerText = "Для связи";
    $(".end-desc").innerText = "Спасибо за внимание";

    language = "ru";
    ls.setItem("language", "ru");
  }
  function enTranslator() {
    $(".color-theme-wrapper > label .switch-desk").innerText = "Color theme";
    $(".color-theme-wrapper > label .switch-desk").classList.remove(
      "switch-desk-ru"
    );
    $(".switch-desk-lang").innerText = "English";
    $(".first-section .h1").innerText = "Anton Yanovskyi";
    $(".first-section .h1").classList.remove("h1-ru");
    $(".first-section .h3").innerText = "Front-end Developer";
    $(".first-section .h3").classList.remove("h3-ru");
    $(".below-first-screen").innerText = "Below are my works";

    $$(".brk-btn").forEach(it => (it.innerText = "visit"));

    $(".portfolio-quiz h2").innerText = "SongBird app on React.js";
    $(".portfolio-quiz h3").innerText =
      "Made a bird app using React and React Hooks";

    $(".portfolio-library h2").innerText = "Quiz on React.js";
    $(".portfolio-library h3").innerText =
      "Made a quiz on React.js using json-server.";
    $(".portfolio-store-react h2").innerText = "Todo List on React.js";
    $(".portfolio-store-react h3").innerText = "Made a to-do list on React.js.";
    $(".portfolio-blog-react h2").innerText = "Layout";
    $(".portfolio-blog-react h3").innerText = "Responsive Landing";
    $(".portfolio-layout h2").innerText = "Layout";
    $(".portfolio-layout h3").innerText = "Responsive Landing";
    $(".my-skills-title").innerText = "My Skills";
    $(".connect-title").innerText = "Get in touch";
    $(".end-desc").innerText = "Thanks for attention";

    language = "en";
    ls.setItem("language", "en");
  }
})();

window.onload = function() {
  let x = 0,
    y = 0.0001,
    w = 0,
    z = 0.0001,
    start = false;

  const welcome1 = setInterval(() => {
    $(".first-section .h1").style.opacity = y;
    x += 0.00017;
    y += x;
    if (y >= 0.23) start = true;
    if (y >= 1) clearInterval(welcome1);
  }, 16);

  const welcome2 = setInterval(() => {
    if (start) {
      $(".first-section .h3").style.opacity = z;
      w += 0.000006;
      z += w;
      if (z >= 1) clearInterval(welcome2);
    }
  }, 2);
};

let pageHeight = document.documentElement.clientHeight;

$(".end-desc").style.paddingBottom = `${pageHeight / 2}px`;
$(".end-desc").style.marginTop = `${pageHeight / 2}px`;

setTimeout(() => ($(".end-desc").style.transition = `4.3s ease`), 300);

window.onscroll = function(e) {
  if ($(".first-desc").getBoundingClientRect().top > 200) {
    $(".first-desc").style.opacity =
      Math.abs($(".first-desc").getBoundingClientRect().top - pageHeight) / 300;
  }

  if (
    $(".first-desc").getBoundingClientRect().top < 200 &&
    $(".first-desc").getBoundingClientRect().top > -1000
  ) {
    $(".first-desc").style.opacity =
      ($(".first-desc").getBoundingClientRect().top + 100) / 200;
  }

  $$(".anime-dis").forEach(function(item) {
    if (item.getBoundingClientRect().top - (pageHeight - 0) < 0)
      item.classList.add("anime");
  });

  $$(".anime-second-dis").forEach(function(item) {
    if (item.getBoundingClientRect().top - (pageHeight - 0) < 0) {
      setTimeout(() => item.classList.add("anime"), 250);
    }
  });

  if ($(".anime-right").getBoundingClientRect().top - (pageHeight - 100) < 0) {
    $$(".anime-right").forEach(function(item, i) {
      item.classList.add("anime");
      item.style.transitionDelay = `${i / 8.3 + 0.1}s`;
    });
  }

  $$(".white-end").forEach(function(item) {
    if (item.getBoundingClientRect().top - pageHeight / 1.8 < 0) {
      document.body.classList.add("wb");
      setTimeout(() => $(".end-desc").classList.add("edn-desc-see"), 1050);
    } else {
      document.body.classList.remove("wb");
      $(".end-desc").classList.remove("edn-desc-see");
    }
  });

  if (ls.getItem("theme") == 0) {
    $$(".white-end").forEach(function(item) {
      if (item.getBoundingClientRect().top - pageHeight / 1.8 < 0) {
        document.body.classList.add("wb");
        setTimeout(() => $(".end-desc").classList.add("edn-desc-see"), 1900);
      } else {
        document.body.classList.remove("wb");
        $(".end-desc").classList.remove("edn-desc-see");
      }
    });
  }

  if (ls.getItem("theme") == 1) {
    $$(".white-end").forEach(function(item) {
      if (item.getBoundingClientRect().top - pageHeight / 1.8 < 0) {
        document.body.classList.add("wb-white");
        setTimeout(
          () => $(".end-desc-white").classList.add("edn-desc-see"),
          1900
        );
      } else {
        document.body.classList.remove("wb-white");
        $(".end-desc-white").classList.remove("edn-desc-see");
      }
    });
  }
};
